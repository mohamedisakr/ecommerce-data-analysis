-- create ecommerce table 
CREATE TABLE ecom_raw
(
Id NUMERIC(10,0),
InvoiceNo VARCHAR(50),
StockCode VARCHAR(50),
Description VARCHAR(250),
Quantity NUMERIC(10,0),
UnitPrice NUMERIC(14,2),
CustomerID VARCHAR(50),
Country VARCHAR(200),
Date DATE,
Hour NUMERIC(3,0)
); 


-- create holiday table
CREATE TABLE holiday_raw
(
Date DATE,
Holiday	VARCHAR(50),
WeekDay	VARCHAR(50),
Month CHAR(2),
Day CHAR(2),
Year CHAR(4)
);


-- load ecommerce data from CSV file
COPY ecom_raw FROM 'E:\Projects\ecommerce-data-analysis\ecommerce_raw_data.csv' DELIMITER ',' CSV NULL 'NULL' HEADER;



-- load holiday data from CSV file
COPY holiday_raw FROM 'E:\Projects\ecommerce-data-analysis\US Holiday Dates (2004-2021).csv' DELIMITER ',' CSV NULL 'NULL' HEADER;



-- get the ecom columns
SELECT Quantity, UnitPrice, Quantity * UnitPrice AS revenue, Date 
FROM ecom_raw
LIMIT 5;



